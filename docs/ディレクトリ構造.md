# ディレクトリ構成

## 構成方針

- Colocationを主軸とし、ルート固有のコードは`app/`内に配置する
- 複数ルートから共有されるコードは`app/`外のグローバルディレクトリに配置する
- グローバル化Colocationかで迷ったら**グローバルに置く**（コードの重複防止を優先、[ADR](ADR/ファイル配置に迷った場合のルール.md) 参照）

## 構成

```
hitokuchi/
├── app/                          # ルーティング + ルート固有のColocation
│   ├── layout.tsx
│   ├── page.tsx
│   ├── globals.css
│   ├── (marketing)/              # Route Group: マーケティング系
│   │   └── layout.tsx
│   ├── (app)/                    # Route Group: アプリ本体
│   │   ├── layout.tsx
│   │   ├── login/
│   │   ├── mypage/
│   │   │   └── _components/      # mypage専用
│   │   ├── whiskeys/
│   │   │   └── _components/      # whiskeys専用
│   │   └── admin/
│   │       └── whiskeys/
│   │           ├── _components/   # admin/whiskeys専用
│   │           ├── new/
│   │           └── [id]/edit/
│   └── api/
│       └── auth/
│           └── callback/
│               └── route.ts      # → /api/auth/callback
├── components/                   # グローバル共有UI
│   ├── ui/                       # 汎用UIパーツ（Button, Input等）
│   └── layout/                   # レイアウト系（Header, Footer等）
├── lib/                          # ドメイン非依存（utils, 定数, クライアント初期化）
│   ├── utils.ts
│   ├── constants.ts
│   └── supabase/
│       ├── client.ts
│       └── server.ts
├── hooks/                        # クライアントサイドのカスタムフック
├── services/                     # ドメイン依存のデータアクセス層
├── types/                        # 共有型定義
├── supabase/                     # Supabase設定・マイグレーション
│   ├── config.toml
│   └── migrations/
└── docs/                         # プロジェクトドキュメント
    ├── ADR/
    └── guides/
```

## 配置基準

| 判断基準 | 配置先 |
|---------|--------|
| 確実にそのルート専用 | `app/ルート/_components/`, `_actions/`, `_lib/` |
| 複数ルートで共有、または判断に迷う | プロジェクトルート直下のグローバルディレクトリ |

## グローバルディレクトリの分離基準

| ディレクトリ | 性質 | 例 |
|-------------|------|-----|
| `lib/` | ドメイン非依存 | utils, 定数, Supabaseクライアント初期化 |
| `services/` | ドメイン依存 | `getRecentBookmarks`, `updateUser` |
| `hooks/` | クライアント専用 | `useMediaQuery`, `useDebounce` |
| `components/` | 共有UI | Button, Modal, Header |
| `types/` | 共有型定義 | 複数箇所から参照される型 |
