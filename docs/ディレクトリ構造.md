# ディレクトリ構成

## 構成方針

- Colocationを主軸とし、ルート固有のコードは`app/`内に配置する
- 複数ルートから共有されるコードは`app/`外のグローバルディレクトリに配置する
- グローバル化Colocationかで迷ったら**グローバルに置く**（コードの重複防止を優先、[ADR](ADR/ファイル配置に迷った場合のルール.md) 参照）

## 構成

```
my-project/
├── app/                      # ルーティング + ルート固有のColocation
│   ├── layout.tsx
│   ├── (marketing)/          # Route Group: マーケティング系
│   │   ├── layout.tsx
│   │   └── _components/      # marketing専用
│   ├── (app)/                # Route Group: アプリ本体
│   │   ├── layout.tsx
│   │   ├── dashboard/
│   │   │   ├── page.tsx
│   │   │   ├── _components/  # dashboard専用
│   │   │   └── _actions/     # dashboard専用Server Actions
│   │   └── settings/
│   │       └── page.tsx
│   └── api/                  # apiはすべてapi/配下に集約
│       └── auth/
│           └── callback/
│               └── route.ts  # → /api/auth/callback
├── components/               # グローバル共有UI
│   ├── ui/                   # 汎用UIパーツ（Button, Input等）
│   └── layout/               # レイアウト系（Header, Footer等）
├── lib/                      # ドメイン非依存（utils, 定数, クライアント初期化）
├── hooks/                    # クライアントサイドのカスタムフック
├── types/                    # 共有型定義
└── services/                 # ドメイン依存のデータアクセス層
```

## 配置基準

| 判断基準 | 配置先 |
|---------|--------|
| 確実にそのルート専用 | `app/ルート/_components/`, `_actions/`, `_lib/` |
| 複数ルートで共有、または判断に迷う | `src/`直下のグローバルディレクトリ |

## グローバルディレクトリの分離基準

| ディレクトリ | 性質 | 例 |
|-------------|------|-----|
| `lib/` | ドメイン非依存 | utils, 定数, Supabaseクライアント初期化 |
| `services/` | ドメイン依存 | `getRecentBookmarks`, `updateUser` |
| `hooks/` | クライアント専用 | `useMediaQuery`, `useDebounce` |
| `components/` | 共有UI | Button, Modal, Header |
| `types/` | 共有型定義 | 複数箇所から参照される型 |
